## 系统架构概述

### 核心设计理念
大学申请追踪系统采用**被动监控**模式，学生无需手动创建或更新申请。系统通过以下方式自动获取申请信息：

1. **Common App API集成** - 自动同步通过Common App提交的申请
2. **大学官网爬虫** - 定期检查申请状态更新
3. **第三方数据源** - 整合Open Data等公开数据源
4. **定时同步机制** - 每4小时自动刷新申请状态

### 用户角色与权限

#### 学生 (Student)
- **主要功能**: 查看申请状态、进度追踪、截止日期提醒
- **权限范围**: 只能查看自己的申请信息
- **操作限制**: 不能创建、编辑或删除申请（只读模式）

#### 家长 (Parent)  
- **主要功能**: 查看关联学生的申请状态、添加备注、接收提醒
- **权限范围**: 只能查看关联学生的申请信息
- **操作限制**: 可以添加备注，但不能修改申请状态

#### 管理员 (Admin)
- **主要功能**: 触发数据同步、监控系统状态、管理用户
- **权限范围**: 系统级管理权限
- **操作限制**: 可以触发同步，但不能直接修改申请数据

### 数据流程

#### 申请数据获取流程
```
外部申请系统 → API/爬虫 → 数据验证 → 状态更新 → 用户通知
     ↓              ↓         ↓         ↓         ↓
  Common App   大学官网   数据清洗   数据库更新   邮件/推送
```

#### 同步策略
- **实时同步**: 重要状态变更（如录取结果）立即同步
- **定时同步**: 每4小时批量同步所有申请状态
- **增量同步**: 只同步有变更的数据，提高效率
- **错误重试**: 同步失败时自动重试，记录错误日志

### 技术架构

#### 前端架构
- **框架**: Next.js (Pages Router) + React + TypeScript
- **样式**: Tailwind CSS
- **状态管理**: React Hooks (useState, useEffect)
- **路由**: Next.js 内置路由系统

#### 后端架构  
- **API框架**: Next.js API Routes
- **数据库**: PostgreSQL (生产) / SQLite (开发)
- **ORM**: Prisma
- **认证**: JWT + Cookie-based
- **外部集成**: HTTP客户端 + 重试机制

#### 数据同步架构
- **调度器**: Node.js cron jobs
- **爬虫引擎**: Puppeteer/Cheerio
- **API客户端**: 支持OAuth2和API Key认证
- **错误处理**: 结构化错误日志 + 告警机制

### 关键功能模块

#### 1. 自动申请同步
- **Common App集成**: 通过官方API获取申请状态
- **大学官网监控**: 定期检查申请进度页面
- **状态映射**: 统一不同来源的状态表示
- **变更检测**: 智能识别状态变更

#### 2. 智能提醒系统
- **截止日期提醒**: 7天内到期的任务高亮显示
- **状态变更通知**: 申请状态更新时自动通知
- **个性化提醒**: 根据用户偏好设置提醒方式

#### 3. 进度可视化
- **申请进度条**: 显示整体完成百分比
- **时间线视图**: 申请关键节点可视化
- **要求清单**: 详细的任务完成状态

#### 4. 家长协作功能
- **学生关联**: 家长可以查看关联学生的申请
- **备注系统**: 家长可以添加私人备注
- **进度分享**: 家长可以了解申请进展

#### 5. 自动登出保护
- **空闲检测**: 10分钟无操作触发警告
- **倒计时警告**: 30秒倒计时弹窗提醒
- **会话延长**: 用户可选择继续使用
- **自动清理**: 超时后自动清除认证状态
- **活动监听**: 实时监听用户交互行为

### 安全与隐私

#### 数据保护
- **加密存储**: 敏感信息使用bcrypt加密
- **访问控制**: 基于角色的权限管理
- **数据隔离**: 用户只能访问自己的数据

#### 会话管理
- **自动登出**: 10分钟无操作后自动登出保护
- **警告弹窗**: 30秒倒计时警告，用户可选择延长会话
- **活动检测**: 监听鼠标、键盘、触摸等用户活动
- **页面可见性**: 页面切换时重置计时器
- **智能重置**: 用户活动自动重置空闲计时器

#### 外部API安全
- **API密钥管理**: 安全的密钥存储和轮换
- **请求限流**: 防止API滥用
- **错误处理**: 不暴露敏感信息

### 部署与运维

#### 环境配置
- **开发环境**: SQLite + 本地文件存储
- **生产环境**: PostgreSQL + 对象存储
- **环境变量**: 敏感配置通过环境变量管理

#### 监控与日志
- **同步日志**: 记录所有外部API调用
- **错误追踪**: 结构化错误日志
- **性能监控**: API响应时间监控

#### 扩展性考虑
- **微服务架构**: 可拆分为独立服务
- **消息队列**: 异步处理大量同步任务
- **缓存策略**: Redis缓存热点数据
